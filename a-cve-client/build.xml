<!-- Author : Rasika Ranaweera -->
<project name="A CVE Client" default="" basedir=".">
	<property name="src.dir" location="src" />
	<property name="lib.dir" location="lib" />
	<property name="build.dir" location="build" />
	<property name="product.name" value="cve-client" />
	<property name="jar.name" value="${product.name}.jar" />
	<property file="build.properties"/>
	
	<path id="project.classpath">
		<fileset dir="${lib.dir}">
			<include name="*.jar" />
		</fileset>
	</path>

	<target name="clean" description="clean all">
		<delete file="${lib.dir}/${jar.name}" />
		<delete dir="${build.dir}" />
	</target>

	<!-- Creating required directories -->
	<target name="prepare">
		<mkdir dir="${build.dir}" />
	</target>

	<!-- Compile the project and generate the required class files -->
	<target name="compile" depends="prepare">
		<javac srcdir="${src.dir}" destdir="${build.dir}" debug="on" deprecation="on" source="1.5" includeantruntime="true">
			<classpath refid="project.classpath" />
		</javac>
	</target>

	<target name="run-sender" description="Run Sender" depends="compile">
		<java dir="${build.dir}" classname="jp.ac.u_aizu.cal.cve.client.Sender" fork="false">
			<classpath path="." />
			<classpath refid="project.classpath" />
			<classpath path="./build" />
			<!-- set the cve server config -->
			<arg value="${sender.host.name}" />
			<arg value="${sender.channel}" />
		</java>
	</target>

	<target name="run-receiver" description="Run Receiver" depends="compile">
		<java dir="${build.dir}" classname="jp.ac.u_aizu.cal.cve.client.Receiver" fork="true">
			<classpath path="." />
			<classpath refid="project.classpath" />
			<classpath path="./build" />
			<!-- set the cve server config -->
			<arg value="${receiver.host.name}" />
			<arg value="${receiver.channel}" />
		</java>
	</target>

    <target name="run-transceiver" description="Run Transceiver" depends="compile">
        <java dir="${build.dir}" classname="jp.ac.u_aizu.cal.cve.client.Transceiver" fork="false">
            <classpath path="." />
            <classpath refid="project.classpath" />
            <classpath path="./build" />
            <!-- set the cve server config -->
            <arg value="${transceiver.host.name}" />
            <arg value="${transceiver.channel}" />
        </java>
    </target>

	<!-- Generate the jar file -->
	<target name="jar" depends="compile" description="Create jar file">
		<delete file="${build.dir}/${jar.name}" />
		<jar destfile="${build.dir}/${jar.name}" basedir="${build.dir}" />
	</target>

</project>
